<!DOCTYPE html>
<html>
  <head>
    <style>
      /* Style for the location display */
      #location {
        font-size: 18px;
        margin-bottom: 10px;
      }

      /* Style for the button */
      #sendButton {
        padding: 10px 20px;
        font-size: 16px;
      }
    </style>
  </head>
  <body>
    <h1>GPS Location Sender</h1>
    <p id="location">Waiting for GPS location...</p>
    <button id="sendButton">Send Location</button>

    <!-- Include MQTT.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mqtt/3.1.0/mqtt.min.js"></script>

    <script>
      // MQTT broker details
      const broker = "mqtt://broker.emqx.io"; // Replace with your broker URL
      const topic = "/RESTful"; // Replace with your desired topic

      // Create a MQTT client
      const client = mqtt.connect(broker);

      // Function to send the location
      function sendLocation(latitude, longitude) {
        const location = {
          latitude: latitude,
          longitude: longitude,
        };

        // Publish the location as a JSON string
        client.publish(topic, JSON.stringify(location));
      }

      // Function to handle the button click event
      function handleButtonClick() {
        navigator.geolocation.getCurrentPosition(
          function (position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;

            // Update the location display
            const locationElement = document.getElementById("location");
            locationElement.textContent = `Latitude: ${latitude}, Longitude: ${longitude}`;

            // Send the location
            sendLocation(latitude, longitude);
          },
          function (error) {
            console.error(error);
          }
        );
      }

      // Add event listener to the button
      const sendButton = document.getElementById("sendButton");
      sendButton.addEventListener("click", handleButtonClick);
    </script>
  </body>
</html>
